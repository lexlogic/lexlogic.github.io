{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}
<div class = 'wrap pt-2 mt-2'>
  <div class = 'grid-3 article_showcase'>
    {{- $paginator := .Paginate $pages -}}
    {{- $size := $paginator.PageSize }}
    {{- $scratch := newScratch }}
    {{- range $index, $value := $paginator.Pages }}
      {{ if isset .Params "image" }}
        {{ $scratch.Set "image" .Params.image }}
      {{ else }}
        {{ $scratch.Set "image" "thumbnail.svg" }}
      {{ end }}
      {{ $image := $scratch.Get "image" }}
      {{ $bg := (absURL (printf "images/%s" $image)) }}
      {{- if in $image "https://" }}
        {{- $bg = $image }}
      {{- end }}
      <article class = 'article mb-2'>
        <a href = '{{ $value.Permalink }}'>
          <div class = 'article_thumb' style='background-image: url({{ $bg }})'></div>
          <div class = 'article_meta'>
            <div class='post_flex'>
              <p class='post_category mb-0'>{{ upper .Params.Category }}</p>
              <time class = 'post_date'>{{ dateFormat "January 02, 2006" $value.Date }}</time>
            </div>
            <h3 class = 'article_title'>{{ $value.Title }}</h3>
            <div class='post_footer'>{{ .Params.Author }}</div>
          </div>
        </a>
      </article>
    {{- end }}
  </div>
</div>
